<!--
CV Builder - Starter single-file web app
Features:
- Form to collect personal info, education, experience, skills, languages
- Simple scoring algorithm to rate CV 1-10
- Shows strengths/weaknesses and suggestions
- Generates a downloadable PDF using jsPDF
- Works entirely in the browser (no backend) so it's easy to host on GitHub Pages or Vercel

How to use this file:
1) Save as `index.html` in a new GitHub repo
2) Open locally (double-click) or serve with `npx serve` for testing
3) Deploy to GitHub Pages (main branch -> Settings -> Pages) or push to Vercel

Notes for improvement:
- Replace client-side PDF generation with a backend for advanced templating
- Add authentication & storage (Firebase / Supabase)
- Add template selection, translations, and richer NLP analysis
-->

<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>CV Builder - Starter</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
  <style>
    :root{--bg:#f7fafc;--card:#ffffff;--accent:#0f172a;--muted:#64748b}
    *{box-sizing:border-box;font-family:Inter,system-ui,Arial}
    body{margin:0;background:var(--bg);color:var(--accent);padding:20px}
    .container{max-width:980px;margin:0 auto}
    header{display:flex;align-items:center;gap:16px;margin-bottom:18px}
    h1{margin:0;font-size:20px}
    .grid{display:grid;grid-template-columns:1fr 360px;gap:20px}
    .card{background:var(--card);padding:16px;border-radius:12px;box-shadow:0 6px 20px rgba(2,6,23,0.06)}
    label{display:block;margin-top:10px;font-weight:600;font-size:13px}
    input[type=text], input[type=email], textarea, select{width:100%;padding:8px;border-radius:8px;border:1px solid #e6edf3;margin-top:6px}
    textarea{min-height:80px}
    .row{display:flex;gap:10px}
    .btn{display:inline-block;padding:10px 14px;border-radius:10px;border:0;background:#0b74ff;color:white;cursor:pointer;margin-top:12px}
    .muted{color:var(--muted);font-size:13px}
    .small{font-size:13px}
    .preview{max-height:72vh;overflow:auto;padding:10px}
    .fieldset{border:1px dashed #e6edf3;padding:10px;border-radius:8px;margin-top:10px}
    .actions{display:flex;gap:8px;flex-wrap:wrap}
    .score{font-size:28px;font-weight:700}
    .suggestions{margin-top:10px}
    .chip{display:inline-block;padding:6px 10px;border-radius:999px;background:#f1f5f9;margin:4px;font-size:13px}
    footer{margin-top:18px;font-size:13px;color:var(--muted)}
  </style>
</head>
<body>
  <div class="container">
    <header>
      <img src="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='44' height='44' viewBox='0 0 24 24' fill='none' stroke='%230b74ff' stroke-width='1.5' stroke-linecap='round' stroke-linejoin='round'><rect x='3' y='3' width='18' height='18' rx='2'/><path d='M8 7h8M8 12h8M8 17h5'/></svg>" alt="logo">
      <div>
        <h1>CV Builder — Starter</h1>
        <div class="muted">Fill the form on the left → preview & score on the right → download PDF</div>
      </div>
    </header>

    <div class="grid">
      <main class="card">
        <form id="cvForm">
          <label>Profile photo (optional)</label>
          <input id="photoInput" type="file" accept="image/*">

          <div class="row">
            <div style="flex:1">
              <label>Full name</label>
              <input id="fullName" type="text" placeholder="e.g. Abdeljalil Ezayani" required>
            </div>
            <div style="width:140px">
              <label>Phone</label>
              <input id="phone" type="text" placeholder="+212...">
            </div>
          </div>

          <label>Email</label>
          <input id="email" type="email" placeholder="you@example.com">

          <label>LinkedIn (optional)</label>
          <input id="linkedin" type="text" placeholder="https://www.linkedin.com/in/...">

          <label>Summary (1–2 short lines)</label>
          <textarea id="summary" placeholder="A concise professional summary"></textarea>

          <div class="fieldset">
            <strong>Education</strong>
            <div id="educationList"></div>
            <button id="addEdu" type="button" class="btn" style="background:#06b6d4">Add education</button>
          </div>

          <div class="fieldset">
            <strong>Experience</strong>
            <div id="experienceList"></div>
            <button id="addExp" type="button" class="btn" style="background:#06b6d4">Add experience</button>
          </div>

          <div class="fieldset">
            <strong>Skills</strong>
            <div id="skillsList"></div>
            <input id="skillInput" placeholder="Add a skill and press Enter" type="text">
          </div>

          <label>Languages (comma separated)</label>
          <input id="languages" placeholder="Arabic, French, English">

          <div style="display:flex;gap:8px;margin-top:12px">
            <button id="generatePdf" class="btn" type="button">Generate PDF</button>
            <button id="scoreBtn" class="btn" type="button" style="background:#111827">Evaluate CV</button>
            <button id="resetBtn" class="btn" type="button" style="background:#ef4444">Reset</button>
          </div>
        </form>

        <div class="muted" style="margin-top:10px">This is a starter demo. For production, add proper validation, accessibility, and backend storage.</div>
      </main>

      <aside class="card preview">
        <div style="display:flex;justify-content:space-between;align-items:center">
          <div style="display:flex;gap:12px;align-items:center">
            <div id="photoPreview" style="width:64px;height:64px;border-radius:10px;background:#eef2ff;display:flex;align-items:center;justify-content:center">No photo</div>
            <div>
              <div id="namePreview" style="font-weight:700">Full Name</div>
              <div id="rolePreview" class="muted small">Phone • Email</div>
            </div>
          </div>
          <div style="text-align:right">
            <div class="muted small">CV Quality</div>
            <div class="score" id="scorePreview">—</div>
          </div>
        </div>

        <hr style="margin:12px 0">

        <div>
          <h4 style="margin:0">Summary</h4>
          <div id="summaryPreview" class="muted small">-</div>
        </div>

        <div style="margin-top:10px">
          <h4 style="margin:0">Education</h4>
          <div id="eduPreview" class="muted small">-</div>
        </div>

        <div style="margin-top:10px">
          <h4 style="margin:0">Experience</h4>
          <div id="expPreview" class="muted small">-</div>
        </div>

        <div style="margin-top:10px">
          <h4 style="margin:0">Skills</h4>
          <div id="skillsPreview" class="muted small">-</div>
        </div>

        <div class="suggestions" id="suggestions"></div>

        <footer>
          Tip: to improve score, add measurable achievements ("Increased sales by 20%"), relevant skills, and a short clear summary.
        </footer>
      </aside>
    </div>
  </div>

  <!-- jsPDF CDN -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js" integrity="sha512-j9b9sR0Xxwq3z5aF1mWf2s1w2eX0X1q6Zc+0s0zv1Yz5v2w+Q0j8y1Kz5xv6yZ0Kj6xY0z5V2w==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

  <script>
    // Simple client-side app logic
    const state = { educations: [], experiences: [], skills: [] }

    // helpers to create dynamic fields
    function makeEduRow(obj={}, idx){
      const wrapper = document.createElement('div')
      wrapper.style.display = 'grid'
      wrapper.style.gridTemplateColumns = '1fr 120px 60px'
      wrapper.style.gap = '8px'
      wrapper.style.marginTop = '8px'
      wrapper.innerHTML = `
        <input class='edu-school' placeholder='School / Institution' value='${obj.school||''}'>
        <input class='edu-degree' placeholder='Degree / Field' value='${obj.degree||''}'>
        <input class='edu-year' placeholder='Year' value='${obj.year||''}'>
      `
      return wrapper
    }
    function makeExpRow(obj={}){
      const wrapper = document.createElement('div')
      wrapper.style.display = 'grid'
      wrapper.style.gridTemplateColumns = '1fr 120px 60px'
      wrapper.style.gap = '8px'
      wrapper.style.marginTop = '8px'
      wrapper.innerHTML = `
        <input class='exp-title' placeholder='Job title' value='${obj.title||''}'>
        <input class='exp-company' placeholder='Company' value='${obj.company||''}'>
        <input class='exp-years' placeholder='Years' value='${obj.years||''}'>
      `
      return wrapper
    }

    // DOM refs
    const educationList = document.getElementById('educationList')
    const experienceList = document.getElementById('experienceList')
    const skillsList = document.getElementById('skillsList')

    document.getElementById('addEdu').addEventListener('click', ()=>{
      educationList.appendChild(makeEduRow())
    })
    document.getElementById('addExp').addEventListener('click', ()=>{
      experienceList.appendChild(makeExpRow())
    })

    // skills input
    const skillInput = document.getElementById('skillInput')
    skillInput.addEventListener('keydown', (e)=>{
      if(e.key === 'Enter' && skillInput.value.trim()){
        const val = skillInput.value.trim()
        state.skills.push(val)
        const span = document.createElement('span')
        span.className = 'chip'
        span.textContent = val
        span.onclick = ()=>{ // remove on click
          state.skills = state.skills.filter(s=>s!==val)
          span.remove(); updatePreview();
        }
        skillsList.appendChild(span)
        skillInput.value = ''
        updatePreview()
      }
    })

    // photo preview
    const photoInput = document.getElementById('photoInput')
    photoInput.addEventListener('change', ()=>{
      const file = photoInput.files[0]
      if(!file) return
      const reader = new FileReader()
      reader.onload = ()=>{
        document.getElementById('photoPreview').innerHTML = `<img src='${reader.result}' style='width:64px;height:64px;border-radius:8px;object-fit:cover'>`
      }
      reader.readAsDataURL(file)
    })

    // reset
    document.getElementById('resetBtn').addEventListener('click', ()=>{
      if(!confirm('Reset the form?')) return
      document.getElementById('cvForm').reset(); educationList.innerHTML=''; experienceList.innerHTML=''; skillsList.innerHTML=''; state.skills=[]; updatePreview(); document.getElementById('photoPreview').textContent='No photo';
    })

    // update preview from fields
    function collectData(){
      const educations = Array.from(educationList.querySelectorAll('div')).map(div=>({
        school: div.querySelector('.edu-school').value,
        degree: div.querySelector('.edu-degree').value,
        year: div.querySelector('.edu-year').value
      })).filter(e=>e.school||e.degree||e.year)

      const experiences = Array.from(experienceList.querySelectorAll('div')).map(div=>({
        title: div.querySelector('.exp-title').value,
        company: div.querySelector('.exp-company').value,
        years: div.querySelector('.exp-years').value
      })).filter(e=>e.title||e.company||e.years)

      return {
        fullName: document.getElementById('fullName').value,
        phone: document.getElementById('phone').value,
        email: document.getElementById('email').value,
        linkedin: document.getElementById('linkedin').value,
        summary: document.getElementById('summary').value,
        educations, experiences, skills: state.skills.slice(), languages: document.getElementById('languages').value
      }
    }

    function updatePreview(){
      const data = collectData()
      document.getElementById('namePreview').textContent = data.fullName || 'Full Name'
      document.getElementById('rolePreview').textContent = [data.phone||'', data.email||''].filter(Boolean).join(' • ')
      document.getElementById('summaryPreview').textContent = data.summary || '-'
      document.getElementById('eduPreview').textContent = data.educations.length ? data.educations.map(e=>`${e.degree||''} — ${e.school||''} (${e.year||''})`).join('\n') : '-'
      document.getElementById('expPreview').textContent = data.experiences.length ? data.experiences.map(e=>`${e.title||''} — ${e.company||''} (${e.years||''})`).join('\n') : '-'
      document.getElementById('skillsPreview').textContent = data.skills.length ? data.skills.join(', ') : '-'
    }

    // live update
    document.getElementById('cvForm').addEventListener('input', updatePreview)
    educationList.addEventListener('input', updatePreview)
    experienceList.addEventListener('input', updatePreview)

    // scoring algorithm (simple)
    function scoreCV(data){
      let score = 0
      // presence
      if(data.fullName) score += 10
      if(data.email) score += 10
      if(data.phone) score += 6
      if(data.summary && data.summary.length>30) score += 12
      // education & experience
      score += Math.min(20, data.educations.length * 6)
      score += Math.min(20, data.experiences.length * 8)
      // skills
      score += Math.min(12, data.skills.length * 3)
      // measurable achievements (detect numbers % or € or $)
      const achievements = (data.experiences.join(' ') + ' ' + data.summary).match(/\d+%|\d+\s?(?:years|year|mo|months|month)|\d+\s?(?:k|K)|\d+/g)
      if(achievements) score += Math.min(10, achievements.length*2)
      // clamp to 0-100 then map to 1-10
      score = Math.max(0, Math.min(100, score))
      return Math.round((score/100)*9)+1
    }

    document.getElementById('scoreBtn').addEventListener('click', ()=>{
      const data = collectData()
      const s = scoreCV(data)
      document.getElementById('scorePreview').textContent = s + '/10'
      // suggestions
      const suggestions = []
      if(!data.summary || data.summary.length < 30) suggestions.push('Add a concise summary (1–2 lines) mentioning your role and strengths.')
      if(data.skills.length < 3) suggestions.push('Add more relevant skills (3+).')
      if(data.experiences.length === 0) suggestions.push('Add at least one professional experience with achievements.')
      if(!data.email) suggestions.push('Add an email address.')
      if(!data.fullName) suggestions.push('Add your full name.')
      const sugDiv = document.getElementById('suggestions')
      sugDiv.innerHTML = ''
      if(suggestions.length===0){ sugDiv.innerHTML = '<div class="muted small">No immediate suggestions — good job!</div>' } else {
        suggestions.forEach(sg=>{ const p=document.createElement('div'); p.className='muted small'; p.textContent='• '+sg; sugDiv.appendChild(p) })
      }
    })

    // generate PDF using jsPDF
    document.getElementById('generatePdf').addEventListener('click', async ()=>{
      const { jsPDF } = window.jspdf
      const data = collectData()
      const doc = new jsPDF({unit:'pt', format:'a4'})
      const margin = 40
      const lineHeight = 14
      let y = 40
      doc.setFontSize(18)
      doc.text(data.fullName || 'Full Name', margin, y)
      doc.setFontSize(11)
      doc.text(`${data.email||''} ${data.phone?(' • '+data.phone):''}`, margin, y+20)
      y += 40
      doc.setFontSize(13)
      doc.text('Summary', margin, y)
      doc.setFontSize(10)
      doc.text(doc.splitTextToSize(data.summary||'-', 520), margin, y+16)
      y += 60
      if(data.educations.length){ doc.setFontSize(13); doc.text('Education', margin, y); y+=16; doc.setFontSize(10); data.educations.forEach(e=>{ doc.text(`${e.degree||''} — ${e.school||''} (${e.year||''})`, margin, y); y+=lineHeight }) ; y+=8 }
      if(data.experiences.length){ doc.setFontSize(13); doc.text('Experience', margin, y); y+=16; doc.setFontSize(10); data.experiences.forEach(e=>{ const left = `${e.title||''} — ${e.company||''}`; doc.text(left, margin, y); if(e.years) doc.text(`${e.years}`, 480, y); y+=lineHeight; }); y+=8 }
      if(data.skills.length){ doc.setFontSize(13); doc.text('Skills', margin, y); y+=16; doc.setFontSize(10); doc.text(data.skills.join(', '), margin, y); y+=16 }
      if(data.languages){ doc.setFontSize(13); doc.text('Languages', margin, y); y+=16; doc.setFontSize(10); doc.text(data.languages, margin, y); y+=16 }

      // footer with score
      const score = scoreCV(data)
      doc.setFontSize(10)
      doc.text(`Generated by CV Builder — Quality score: ${score}/10`, margin, 780)

      doc.save((data.fullName||'cv') + '.pdf')
    })

    // initial preview
    updatePreview()
  </script>
</body>
</html>
